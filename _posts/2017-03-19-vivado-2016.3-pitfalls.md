---
layout: post
title:  "谨防掉进2016.3在嵌入式方面的这些坑"
date:   2017-03-19 12:00:00
categories: Experiences
tags:
- PetaLinux
- SDK
- FSBL
- u-boot
---
# 在u-boot和Linux中下载Bit文件

[http://www.wiki.xilinx.com/Solution+ZynqMP+PL+Programming] 有如何在u-boot/Linux下配置PL的流程。注意需要先加入这个PMUFW的补丁，保证下载bit文件后能正确将PL复位，否则PS不能访问PL的地址。

[https://www.xilinx.com/support/answers/68246.html]

# FSBL没有配置PS-PL AXI 总线数据位宽
在Vivado中配置额外i32或64位宽的总线，会发现读写0x0地址是正确的，0x4, 0x8, 0xc地址出现错误，是因为总线状态还停留在128位。使用AR中的方法可以解决。

[https://www.xilinx.com/support/answers/68166.html]

[https://www.xilinx.com/support/answers/66295.html]

# Bootgen 默认没有为u-boot和ATF添加Exception Level的参数
会导致u-boot和Linux不能启动。比较保险的方式是用PetaLinux的petalinux-package --boot 工具产生boot.bin

# u-boot和Linux的Reboot命令不能正常重启
这是PMUFW的问题引起。在AR中有一个workaround，进行PS Only Reset。

[https://www.xilinx.com/support/answers/68514.html]

# MPSoC PL中例化的MicroBlaze可能会无法用XSDB连接
参考[https://www.xilinx.com/support/answers/68439.html]，因为MDM的一些异步信号需要额外的时序约束。
